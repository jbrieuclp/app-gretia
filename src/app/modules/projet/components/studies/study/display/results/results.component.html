<!-- <form [formGroup]="form">
			
	<div class="row">
	  <mat-form-field class="col-md-2">
	  	<mat-label>Date de début</mat-label>
		  <input 
		  	matInput 
		  	[matDatepicker]="startP" 
		  	placeholder="jj/mm/aaaa" 
		  	formControlName="start"
		  	required>
		  <mat-datepicker-toggle matSuffix [for]="startP"></mat-datepicker-toggle>
		  <mat-datepicker #startP></mat-datepicker>
		</mat-form-field>

	  <mat-form-field class="col-md-2">
	  	<mat-label>Date de fin</mat-label>
		  <input 
		  	matInput 
		  	[matDatepicker]="endP" 
		  	placeholder="jj/mm/aaaa" 
		  	formControlName="end">
		  <mat-datepicker-toggle matSuffix [for]="endP"></mat-datepicker-toggle>
		  <mat-datepicker #endP></mat-datepicker>
		</mat-form-field>
	</div>

	<button 
		mat-raised-button 
		color="primary"
		[disabled]="form.invalid || waiting"
		(click)="getWorks()"
	> {{ waiting ? 'Ca arrive...' : 'Afficher'}} </button>

</form> -->

<div class="mat-table-container mat-elevation-z8">
  <div 
    *ngIf="loading"
    class="loading-shade"
  >
    <mat-spinner></mat-spinner>
  </div>

  <div class="table-container">
		<table 
			mat-table 
			[dataSource]="worksSource" 
		  matSort 
		  matSortActive="workingDate"
		  matSortDisableClear 
		  matSortDirection="desc"
		>
		  <!-- Code Column -->
		  <ng-container matColumnDef="employee.person.firstname">
		    <th 
		    	mat-header-cell 
		    	*matHeaderCellDef
		    	mat-sort-header
		    > Salarié </th>
		    <td mat-cell *matCellDef="let row">
		    	{{ row.employee.person.firstname }} {{ row.employee.person.name }}
		    </td>
		    <td 
		    	mat-footer-cell 
		    	*matFooterCellDef 
		    	[attr.colspan]="displayedColumns.length-1"
		    > TOTAL </td>
		  </ng-container>

		  <!-- Études Column -->
		  <ng-container matColumnDef="workingDate">
		    <th 
		    	mat-header-cell 
		    	*matHeaderCellDef
		    	mat-sort-header
		    >Date</th>
		    <td mat-cell *matCellDef="let row">{{ row.workingDate|date:'dd/MM/yyyy' }}</td>
		  </ng-container>

		  <!-- expectedTime Column -->
		  <ng-container matColumnDef="category.label">
		    <th 
		    	mat-header-cell 
		    	*matHeaderCellDef
		    	mat-sort-header
		    > Action </th>
		    <td mat-cell *matCellDef="let row">{{ row.category.label }}</td>
		  </ng-container>

		  <!-- expectedTime Column -->
		  <ng-container matColumnDef="detail">
		    <th 
		    	mat-header-cell 
		    	*matHeaderCellDef
		    > Détail </th>
		    <td mat-cell *matCellDef="let row">{{ row.detail }}</td>
		  </ng-container>

		  <!-- expectedTime Column -->
		  <ng-container matColumnDef="duration">
		    <th 
		    	mat-header-cell 
		    	*matHeaderCellDef
		    	mat-sort-header
		    > Durée </th>
		    <td mat-cell *matCellDef="let row">{{ row.duration | timeFormat }}</td>
		    <td mat-footer-cell *matFooterCellDef>
					{{ totalDuration | timeFormat}}
        </td>
		  </ng-container>

		  <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
		  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
		  <tr 
		  	mat-footer-row 
		  	*matFooterRowDef="['employee.person.firstname', 'duration']"
		 	></tr>
		</table>

	</div>
</div>


<table class="table table-bordered">
	<thead>
		<tr>
			<th> </th>
			<th> Dépenses </th>
			<th> Financements </th>
		</tr>
	</thead>
	<tbody>
		
	</tbody>
		<ng-container *ngIf="actions.length > 0">
			<tr> <th colspan="3"> Actions</th> </tr>
			<tr *ngFor="let action of actions">
				<td> {{ action.label }} </td>
				<td> {{ action.numberDaysDone * study.dailyCost }} € </td>
				<td> 
					{{ action.nbOfDays * study.dailyCost }} € <br>
					<small>({{ action.nbOfDays }} jours x {{ study.dailyCost }} €/j)</small></td>
			</tr>
		</ng-container>
		<ng-container *ngIf="charges.length > 0">
			<tr> <th colspan="3"> Charges </th> </tr>
			<tr *ngFor="let charge of charges">
				<td> {{ charge.label }} </td>
				<td> {{ charge.cost * charge.quantity }} € </td>
				<td> {{ charge.cost * charge.quantity }} € <br>
			</tr>
		</ng-container>
<!-- 	<tbody>
		<tr>
			<th colspan="2"> Financements </th>
			<td colspan="2"> 
				<ng-container *ngIf="!studyS.loadingStudy; else queryLoader">
					{{ study.funding }}
				</ng-container>
			</td>
		</tr>
		<tr class="table-secondary">
			<th colspan="2"> Dépenses </th>
			<th> Prévisionelles </th>
			<th> Réelles </th>
		</tr>
		<tr>
			<td></td>
			<th> Actions </th>
			<td> 
				<ng-container *ngIf="!studyMontagesS.loading; else queryLoader">
					- {{ actionsPreviCost }}
				</ng-container>
			</td>
			<td> 
				<ng-container *ngIf="!studyMontagesS.loading; else queryLoader">
					- {{ actionsRealCost }}
				</ng-container>
			</td>
		</tr>
		<tr>
			<td></td>
			<th> Matériels </th>
			<td> 
				<ng-container *ngIf="!studyMontagesS.loading; else queryLoader">
					- {{ materialsTotalCost }}
				</ng-container>
			</td>
			<td> 
				<ng-container *ngIf="!studyMontagesS.loading; else queryLoader">
					- {{ materialsTotalCost }}
				</ng-container>
			</td>
		</tr>
	</tbody>
	<tfoot>
		<tr>
			<th 
				class="table-dark"
				colspan="2"
			> Total </th>
			<td class="table-dark"> 
				<ng-container *ngIf="!studyS.loadingStudy && !studyMontagesS.loading; else queryLoader">
					{{ study.funding - (actionsPreviCost + materialsTotalCost) }}
				</ng-container>
			</td>
			<td class="table-dark"> 
				<ng-container *ngIf="!studyS.loadingStudy && !studyMontagesS.loading; else queryLoader">
					{{ study.funding - (actionsRealCost + materialsTotalCost) }}
				</ng-container>
			</td>
		</tr>
	</tfoot> -->
</table>